{{- $class := "" -}}
{{- with .Get "class" -}}
{{- $class = . -}}
{{- end -}}
{{- $lb := "" -}}
{{- with (.Get "hl-lightbox") -}}
{{- $lb = . -}}
{{- end -}}
{{- with .Get "name" -}}
{{- $name := . -}}
{{- range $.Page.Resources.ByType "image" -}}
{{- if eq .Name $name -}}
{{- $s := .Resize "480x" -}}
{{- $m := .Resize "800x" -}}
{{- $l := .Resize "1200x" -}}
<figure class="{{ $class }}">
<img data-src="{{ $l.Permalink }}" data-srcset="{{- $s.Permalink }} {{ $s.Width -}}w, {{ $m.Permalink }} {{ $m.Width -}}w, {{ $l.Permalink }}  {{ $l.Width -}}w"
     sizes="(max-width: {{ $s.Width -}}px) {{ $s.Width -}}px, (max-width: {{ $m.Width -}}px) {{ $m.Width -}}px 100vw" width="{{- $l.Width -}}" height="{{- $l.Height -}}"
     alt="{{- with .Title }}{{ . }}{{- end -}}" {{ if $lb }}onclick="UIkit.lightbox('#lb-{{- $name -}}').show(0);" style="cursor: pointer"{{ end }} uk-img>
{{- with .Title }}<figcaption>{{ . }}</figcaption>{{- end -}}
</figure>
{{- end -}}
{{- end -}}
{{- with $lb -}}
{{- $headless := $.Site.GetPage . -}}
{{- $images := $headless.Resources.ByType "image" -}}
<div id="lb-{{- $name -}}" uk-lightbox>
    {{- range sort $images "Name" "desc" -}}
    <a href="{{ .Permalink }}" {{- with .Title -}}data-caption="{{ . }}"{{- end -}}></a>
    {{- end -}}
</div>
{{- end -}}
{{- end -}}